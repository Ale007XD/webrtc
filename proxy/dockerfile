FROM nginx:alpine

Install certbot for Let's Encrypt
RUN apk add --no-cache certbot certbot-nginx openssl

Copy nginx configuration
COPY nginx.conf /etc/nginx/nginx.conf
COPY entrypoint.sh /entrypoint.sh

Make entrypoint executable
RUN chmod +x /entrypoint.sh

Create directories for certificates and logs
RUN mkdir -p /etc/letsencrypt /var/log/nginx

Expose ports
EXPOSE 80 443

Use custom entrypoint
ENTRYPOINT ["/entrypoint.sh"]
